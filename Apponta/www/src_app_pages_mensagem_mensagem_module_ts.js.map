{"version":3,"file":"src_app_pages_mensagem_mensagem_module_ts.js","mappings":"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","sources":["./src/app/pages/mensagem/mensagem-routing.module.ts","./src/app/pages/mensagem/mensagem.module.ts","./src/app/pages/mensagem/mensagem.page.ts","./src/app/pages/mensagem/mensagem.page.scss"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MensagemPage } from './mensagem.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MensagemPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MensagemPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MensagemPageRoutingModule } from './mensagem-routing.module';\n\nimport { MensagemPage } from './mensagem.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    MensagemPageRoutingModule,\n  ],\n  declarations: [MensagemPage]\n})\nexport class MensagemPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { MensagemService } from 'src/app/api/mensagem.service';\nimport { CentroCusto, Contato, Equipamento, Mensagem } from 'src/app/interface/reval';\nimport { NovaMensagemPage } from 'src/app/nova-mensagem/nova-mensagem.page';\nimport { DbService } from 'src/app/storage/db.service';\n\n@Component({\n  selector: 'app-mensagem',\n  templateUrl: './mensagem.page.html',\n  styleUrls: ['./mensagem.page.scss'],\n})\nexport class MensagemPage implements OnInit {\n\n  public contatoMsg: Contato[]\n  public contatoMsg2: Contato[]\n  public idLidas: number = 2\n  public idEquipamento: number\n  public equipamentos: Equipamento[] \n  public centrosCusto: CentroCusto[]\n  public equipamento: Equipamento\n  public numMsg: number\n  public intervalMsg: any;\n\n\n  constructor(\n    public msgSvc: MensagemService,\n    public db: DbService,\n    public nova: NovaMensagemPage,\n    private router: Router\n\n  ) { }\n\n  ionViewDidLeave() {\n    clearInterval(this.intervalMsg);\n  }\n\n  ngOnInit() {\n    this.equipamento = this.db.carregaEquipamento();\n   this.idEquipamento = this.equipamento?.id;\n\n  \n    //console.log(this.db.centrosCusto)\n  }\n\n  ionViewDidEnter() {\n    this.carregaMsg()\n\n    this.intervalMsg = setInterval(()=>{\n      this.carregaMsg();\n    },5000)\n  }\n\n  carregaMsg() {\n\n    this.msgSvc.GetContato(\n      {\n        token: this.db.getToken(),\n\n      }\n    ).subscribe(\n      (ret) => {\n  //      console.log(ret.contatos)\n //       console.log(this.contatoMsg)\n//console.log(JSON.stringify(ret.contatos))\n//console.log(JSON.stringify(this.contatoMsg))\n       if(JSON.stringify(ret.contatos) !== JSON.stringify(this.contatoMsg)) {\n          console.log('diferentes')\n          this.contatoMsg = ret.contatos;\n          this.contatoMsg2 = ret.contatos;\n     } else           console.log('iguais')\n\n      },\n      (err) => this.db.escondeProcessando(err.error)\n    )  \n    \n  \n  }\n\n  async novaMensagem() {\n    const ret = await this.nova.novaMensagem();\n    if (ret.data.status) {\n      this.carregaMsg();\n    }\n\n  }\n\n  busca(evt: any) {\n    this.contatoMsg = this.contatoMsg2.filter((cc) => {\n      return this.db.compara([cc.ultimaMensagem,cc.contato], evt.detail.value);\n    });\n  }\n\n   abreConversa(idContato: string, contato: string){\nthis.db.setContato(idContato, contato);\nthis.router.navigateByUrl(\"mensagem-contato\")\n  } \n\n  AbreMensagem(){\n\n    this.carregaMsg\n  }\n}\n","// Imports\nvar ___CSS_LOADER_API_SOURCEMAP_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\");\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, ``, \"\",{\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"sourceRoot\":\"\"}]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___.toString();\n"],"names":["NgModule","RouterModule","MensagemPage","routes","path","component","MensagemPageRoutingModule","__decorate","imports","forChild","exports","CommonModule","FormsModule","IonicModule","MensagemPageModule","declarations","Component","Router","MensagemService","NovaMensagemPage","DbService","msgSvc","db","nova","router","contatoMsg","contatoMsg2","idLidas","idEquipamento","equipamentos","centrosCusto","equipamento","numMsg","intervalMsg","constructor","ionViewDidLeave","clearInterval","ngOnInit","carregaEquipamento","id","ionViewDidEnter","carregaMsg","setInterval","GetContato","token","getToken","subscribe","ret","JSON","stringify","contatos","console","log","err","escondeProcessando","error","novaMensagem","_this","_asyncToGenerator","data","status","busca","evt","filter","cc","compara","ultimaMensagem","contato","detail","value","abreConversa","idContato","setContato","navigateByUrl","AbreMensagem","selector","template","__NG_CLI_RESOURCE__0"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}