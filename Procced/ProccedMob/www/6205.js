"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6205],{6205:(N,p,r)=>{r.r(p),r.d(p,{LoginPageModule:()=>T});var g=r(177),u=r(4341),a=r(9893),m=r(4932),b=r(467),e=r(4438),v=r(1520),S=r(3727),f=r(5035),k=r(5308),_=r(4680),C=r(6873);const P=["emailInput"];function L(s,h){1&s&&(e.j41(0,"ion-item",15)(1,"div",16)(2,"ion-label",23),e.EFF(3,"Data de nascimento"),e.k0s(),e.nrm(4,"ion-input",24),e.k0s()())}function M(s,h){1&s&&(e.j41(0,"ion-item",15)(1,"div",16)(2,"ion-label",23),e.EFF(3,"Nova senha"),e.k0s(),e.nrm(4,"ion-input",25),e.k0s()())}function D(s,h){if(1&s){const i=e.RV6();e.j41(0,"form",10,0),e.bIt("ngSubmit",function(){e.eBV(i);const o=e.sdS(1),n=e.XpG();return e.Njj(n.login(o))}),e.j41(2,"ion-grid")(3,"ion-row",11)(4,"ion-col",12)(5,"ion-item",13)(6,"div")(7,"ion-input",14,1),e.mxI("ngModelChange",function(o){e.eBV(i);const n=e.XpG();return e.DH7(n.email,o)||(n.email=o),e.Njj(o)}),e.k0s()()(),e.j41(9,"ion-item",15)(10,"div",16),e.nrm(11,"ion-input",17),e.k0s()(),e.DNE(12,L,5,0,"ion-item",18)(13,M,5,0,"ion-item",18),e.j41(14,"ion-button",19),e.EFF(15,"Entrar "),e.k0s()()(),e.j41(16,"ion-row")(17,"ion-col",20),e.EFF(18),e.k0s(),e.j41(19,"ion-col",21)(20,"ion-label",22),e.bIt("click",function(){e.eBV(i);const o=e.XpG();return e.Njj(o.resetSenha=!0)}),e.EFF(21,"Esqueci minha senha"),e.k0s()()()()()}if(2&s){const i=e.sdS(1),t=e.XpG();e.R7$(7),e.R50("ngModel",t.email),e.R7$(5),e.Y8G("ngIf",t.solNascimento),e.R7$(),e.Y8G("ngIf",t.solNovaSenha),e.R7$(),e.Y8G("disabled",i.invalid),e.R7$(4),e.SpI(" ",t.db.versao," ")}}function j(s,h){if(1&s){const i=e.RV6();e.j41(0,"form",10,0),e.bIt("ngSubmit",function(){e.eBV(i);const o=e.sdS(1),n=e.XpG();return e.Njj(n.esqueciSenha(o))}),e.j41(2,"ion-grid")(3,"ion-row",11)(4,"ion-col",12)(5,"ion-item",13)(6,"div")(7,"ion-input",26),e.mxI("ngModelChange",function(o){e.eBV(i);const n=e.XpG();return e.DH7(n.email,o)||(n.email=o),e.Njj(o)}),e.k0s()()(),e.j41(8,"ion-button",19),e.EFF(9,"Recuperar senha "),e.k0s()()(),e.j41(10,"ion-row")(11,"ion-col",21)(12,"ion-label",22),e.bIt("click",function(){e.eBV(i);const o=e.XpG();return e.Njj(o.resetSenha=!1)}),e.EFF(13,"Voltar"),e.k0s()()()()()}if(2&s){const i=e.sdS(1),t=e.XpG();e.R7$(7),e.R50("ngModel",t.email),e.R7$(),e.Y8G("disabled",i.invalid)}}const y=[{path:"",component:(()=>{class s{svc;db;platform;routerOutlet;router;plt;route;docSvc;selNot;wsSvc;emailInput;logo;email;resetSenha;backButtonListenerHandle;tipoLogin="usuario";solNascimento=!1;solNovaSenha=!1;menuCtrl;data=null;param;solicitaLogin;constructor(i,t,o,n,c,d,l,U,I,G){this.svc=i,this.db=t,this.platform=o,this.routerOutlet=n,this.router=c,this.plt=d,this.route=l,this.docSvc=U,this.selNot=I,this.wsSvc=G}noticias(){this.router.navigateByUrl("home",{replaceUrl:!0})}ngOnInit(){this.db.app&&console.log(this.db.app.logo),this.tipoLogin=this.db.getTipoLogin()}ionViewDidEnter(){this.route.params.subscribe(i=>{if(console.log("entrou"),this.param=i.param?i.param:this.db.param,this.param&&""!==this.param){let t=this.param.split("|");null!=t[2]?this.svc.SolicitaLogin({usuario:t[1],idDocumento:t[0],chave:t[2]}).subscribe(o=>{if("false"==o.solicitaLogin)if("COM"==t[0].substr(0,3)){let n=this.getCodigoSemDV(t[0].substr(4));this.docSvc.abreDocumento("sl|"+t[1]+"|"+t[2],"COM_"+n,()=>{})}else{let n=this.getCodigoSemDV(t[0]);this.docSvc.abreDocumento("sl|"+t[1]+"|"+t[2],n,()=>{})}else this.processaLogin(this.param)}):this.processaLogin(this.param)}else this.db.limpaSessao(),this.logo=this.db.getLogo(),this.email=this.db.getUsuario();console.log(this.param)})}ionViewDidLeave(){this.backButtonListenerHandle&&(this.backButtonListenerHandle.remove(),this.backButtonListenerHandle=null)}retornaApenasDigitos(i){let t="";for(let o=0;o<i.length;o++)i[o]>="0"&&i[o]<="9"&&(t+=i[o]);return t}getCodigoSemDV(i){let t=i.toString(),o=t.substr(-1,1),n=t.substr(0,1);t=t.substr(1,t.length-2);let c=this.db.mod10(t),d=this.db.mod10(t+c);return c!==o||d!==n?(this.db.setMensagem("Token inv\xe1lido"),-1):+t}login(i){this.db.setTipoLogin(this.tipoLogin);let t=this.retornaApenasDigitos(i.value.email.trim());""==t||11!=t.length?(this.db.mostraProcessando(),this.svc.GetToken({usuario:i.value.email,senha:i.value.password,platform:this.plt.is("desktop")?1:2,player_id:this.db.pushToken}).subscribe(o=>{this.db.escondeProcessando(o.error),"true"==o.status&&(this.db.getUsuario()!==i.value.email&&this.db.limpaSessao(),this.db.setUsuario(i.value.email),this.db.pushPage&&this.selNot.selecionaNotificacao(),this.param?(console.log("this.param: "+this.param),this.db.setApp(o.tokenApps[0],!1),this.processaLogin(this.param)):(this.db.setApp(o.tokenApps[0]),this.db.mostraMenu=!0))},o=>{this.db.escondeProcessando(o.error)})):(i.value.email=t,1==this.solNascimento&&(this.data=this.retornaApenasDigitos(i.value.nascimento.trim()),console.log(this.data),this.data=this.data.substr(4,4)+"-"+this.data.substr(2,2)+"-"+this.data.substr(0,2)),console.log(i.value.nascimento),console.log(i.value.novaSenha),this.db.mostraProcessando(),this.svc.GetTokenColaborador({cpf:i.value.email,senha:i.value.password,nascimento:this.solNascimento?this.data:null,novaSenha:i.value.novaSenha,platform:this.plt.is("desktop")?1:2,player_id:this.db.pushToken}).subscribe(o=>{"true"==o.status?(this.db.escondeProcessando(),this.param&&(console.log("this.param: "+this.param),this.db.setUsuario(i.value.email),this.db.setAppColaborador(o.tokenApps[0]),this.processaLogin(this.param)),this.db.getUsuario()!==i.value.email&&this.db.limpaSessao(),this.db.setUsuario(i.value.email),this.db.setAppColaborador(o.tokenApps[0]),this.router.navigate(["documentos-colaborador"]),this.db.pushPage&&this.selNot.selecionaNotificacao()):"false"==o.status&&(-4002==o.errorId?(this.solNascimento=!0,this.db.escondeProcessando("Informe sua data de nascimento")):-4003==o.errorId?(this.solNovaSenha=!0,this.db.escondeProcessando("Defina uma senha")):this.db.escondeProcessando(o.error))},o=>{this.db.escondeProcessando(o.error)}))}processaLogin(i){if(!i)return!0;{this.db.param="";let t=i.split("|");if(console.log(t),this.db.setApp(this.db.getApp()),console.log(this.db.getUsuario()),!this.db.app||!this.db.app.token||t[1]!=this.db.getUsuario().toUpperCase())return this.router.navigateByUrl("login/"+i,{replaceUrl:!0}),console.log(t[1]),this.emailInput.value=t[1],console.log(this.emailInput.value),!1;if("COM"==t[0].substr(0,3)){let o=this.getCodigoSemDV(t[0].substr(4));console.log(t),this.db.app=this.db.getApp(),this.db.app&&this.db.app.token&&(this.db.getExpiraToken(),this.db.timer>0&&(this.docSvc.abreDocumento(this.db.app.token,"COM_"+o,()=>{}),this.router.navigate(["tabs/documentos"])))}else if("COL"==t[0].substr(0,3)){let o=t[0].substr(4);console.log(o),console.log(t),this.db.app=this.db.getApp(),this.db.app&&this.db.app.token&&(this.db.getExpiraToken(),this.db.timer>0&&this.abreDocumentoColaborador(this.db.app.token,o,()=>{},!1),this.router.navigate(["documentos-colaborador"]))}else{let o=this.getCodigoSemDV(t[0]);console.log(t),this.db.app=this.db.getApp(),this.db.app.token&&(this.db.getExpiraToken(),this.db.timer>0&&this.docSvc.abreDocumento(this.db.app.token,+o,()=>{}),this.router.navigate(["tabs/documentos"]))}}}abreDocumentoColaborador(i,t,o,n){var c=this;this.db.mostraProcessando(),this.plt.is("android")&&this.plt.is("capacitor")?this.svc.GetDocumentoColaborador({token:this.db.app.token,tokenDocumento:t,tipoRetorno:1}).subscribe(d=>{this.db.renovaToken(d.novoToken),this.wsSvc.fileWrite(d.titulo,d.conteudo),this.db.escondeProcessando(),o()}):n?this.svc.GetDocumentoColaborador({token:this.db.app.token,tokenDocumento:t,tipoRetorno:1}).subscribe(function(){var d=(0,b.A)(function*(l){c.db.escondeProcessando(),"true"==l.status?(c.db.renovaToken(l.novoToken),c.docSvc.salvaArquivo(l.conteudo,l.titulo),o()):c.db.setMensagem(l.error)});return function(l){return d.apply(this,arguments)}}()):n||this.svc.GetDocumentoColaborador({token:this.db.app.token,tokenDocumento:t,tipoRetorno:2}).subscribe(function(){var d=(0,b.A)(function*(l){c.db.escondeProcessando(),"true"==l.status?(window.location.assign(l.link),o()):c.db.setMensagem(l.error)});return function(l){return d.apply(this,arguments)}}()),this.db.escondeProcessando()}esqueciSenha(i){console.log("form:",i),""==i.value.email?this.db.setMensagem("Informe o usu\xe1rio"):this.svc.ResetaSenha({usuario:i.value.email,metodo:"email"}).subscribe(t=>{t.error?this.db.setMensagem(t.error):(this.db.setMensagem("Enviado email com nova senha"),this.resetSenha=!1)})}segmentChanged(i){console.log("Segment changed",i),this.tipoLogin=i.detail.value}static \u0275fac=function(t){return new(t||s)(e.rXU(v.o),e.rXU(S.a),e.rXU(f.OD),e.rXU(a.Rg),e.rXU(m.Ix),e.rXU(f.OD),e.rXU(m.nX),e.rXU(k.g),e.rXU(_.q),e.rXU(C.o))};static \u0275cmp=e.VBU({type:s,selectors:[["app-login"]],viewQuery:function(t,o){if(1&t&&e.GBs(P,5),2&t){let n;e.mGM(n=e.lsd())&&(o.emailInput=n.first)}},decls:14,vars:3,consts:[["form","ngForm"],["emailInput",""],["small","","color","primary"],["slot","start"],[3,"click"],["color","primary","slot","icon-only","name","arrow-back-outline"],["padding",""],[2,"margin-top","50px"],[2,"margin","auto","max-width","250px",3,"src"],[3,"ngSubmit",4,"ngIf"],[3,"ngSubmit"],["justify-content-center",""],["align-self-center",""],[1,"itemSemBorda",2,"margin-top","30px"],["name","email","type","email","placeholder","E-mail, Usu\xe1rio ou CPF","ngModel","","required","",2,"margin","auto",3,"ngModelChange","ngModel"],[1,"itemSemBorda",2,"margin-bottom","30px"],[2,"width","50%","margin","auto"],["name","password","type","password","placeholder","Senha","ngModel","","required",""],["class","itemSemBorda","style","margin-bottom: 30px",4,"ngIf"],["size","large","color","primary","type","submit","expand","block",1,"btnEntrar",3,"disabled"],[2,"font-size","x-small"],[2,"text-align","right"],[1,"esqueciSenha",3,"click"],["position","float"],["name","nascimento","type","text","ngModel","","required","","placeholder","dd/mm/aaaa"],["name","novaSenha","type","password","ngModel","","required",""],["name","email","type","email","placeholder","E-mail , Usu\xe1rio ou CPF ","ngModel","","required","",2,"margin","auto",3,"ngModelChange","ngModel"]],template:function(t,o){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",2),e.EFF(3," Login "),e.k0s(),e.j41(4,"ion-buttons",3)(5,"ion-button",4),e.bIt("click",function(){return o.noticias()}),e.nrm(6,"ion-icon",5),e.k0s()()()(),e.j41(7,"ion-content",6)(8,"ion-grid")(9,"ion-row")(10,"ion-col",7),e.nrm(11,"ion-img",8),e.k0s()()(),e.DNE(12,D,22,5,"form",9)(13,j,14,2,"form",9),e.k0s()),2&t&&(e.R7$(11),e.Y8G("src",o.db._URL_LOGO),e.R7$(),e.Y8G("ngIf",!o.resetSenha),e.R7$(),e.Y8G("ngIf",o.resetSenha))},dependencies:[g.bT,u.qT,u.BC,u.cb,u.YS,u.vS,u.cV,a.Jm,a.QW,a.hU,a.W9,a.lO,a.eU,a.iq,a.KW,a.$w,a.uz,a.he,a.ln,a.BC,a.ai,a.Gw],styles:[".itemSemBorda[_ngcontent-%COMP%]{display:flex}.itemSemBorda[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{margin:auto}div[_ngcontent-%COMP%]{width:50%;margin:auto;min-width:250px}.btnEntrar[_ngcontent-%COMP%]{min-width:250px}.esqueciSenha[_ngcontent-%COMP%]{color:var(--ion-color-primary);cursor:pointer;font-size:smaller}"]})}return s})()}];let x=(()=>{class s{static \u0275fac=function(t){return new(t||s)};static \u0275mod=e.$C({type:s});static \u0275inj=e.G2t({imports:[m.iI.forChild(y),m.iI]})}return s})(),T=(()=>{class s{static \u0275fac=function(t){return new(t||s)};static \u0275mod=e.$C({type:s});static \u0275inj=e.G2t({imports:[g.MD,u.YN,a.bv,x]})}return s})()}}]);