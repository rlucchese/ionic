"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7236],{7236:($,v,l)=>{l.r(v),l.d(v,{BaixaPageModule:()=>H});var g=l(177),h=l(4341),s=l(9893),p=l(4932),f=l(467),i=l(4438),b=l(6541),x=l(5035),B=l(3727),C=l(6096);function k(n,d){if(1&n&&(i.j41(0,"ion-item",11)(1,"ion-grid",12)(2,"ion-row")(3,"ion-col",13),i.EFF(4),i.k0s()(),i.j41(5,"ion-row")(6,"ion-col",13),i.EFF(7),i.k0s()()()()),2&n){const e=i.XpG();i.ZvI("container classe",e.getNivel(e.atividade.classificacao),""),i.R7$(3),i.HbH("classe"+e.getNivel(e.atividade.classificacao)+" linhaDetalhe"),i.R7$(),i.SpI(" ",e.atividade.descricao,""),i.R7$(2),i.HbH("classe"+e.getNivel(e.atividade.classificacao)+" linhaDetalhe"),i.R7$(),i.SpI(" ",e.atividade.txtExpl,"")}}function M(n,d){1&n&&i.nrm(0,"app-atividade",15),2&n&&i.Y8G("atividade",d.$implicit)}function j(n,d){if(1&n&&(i.j41(0,"div"),i.DNE(1,M,1,1,"app-atividade",14),i.k0s()),2&n){const e=i.XpG();i.R7$(),i.Y8G("ngForOf",e.atividade.atividades)}}function I(n,d){1&n&&i.nrm(0,"div",16)}let R=(()=>{class n{mostraDetalhes=!1;atividade;onChange=new i.bkB;constructor(){}ngOnInit(){}checkAtividade(e){e.checked=!e.checked,console.log(e)}getNivel(e){let o=e.match(/\./g);return o?o.length:0}processaArvore(e){if(console.log("arvore"),console.log(e,e.pai),e.pai)if(console.log("tem pai"),e.checked){console.log("ticado");let o=!0;e.pai.atividades.forEach(a=>{a.checked||(o=!1)}),o&&(e.pai.checked=!0,this.processaArvore(e.pai))}else console.log("n\xe3o ticado"),e.pai.checked&&(e.pai.checked=!1,this.processaArvore(e.pai))}check(e){e.checked=!e.checked,this.processaArvore(e)}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=i.VBU({type:n,selectors:[["app-atividade"]],inputs:{atividade:"atividade"},outputs:{onChange:"onChange"},decls:19,vars:20,consts:[["lines","none",1,"container"],["fixed","",1,"ion-no-padding",3,"click"],["size-md","8","size-sm","12","size-xs","12",1,"wrap"],[1,"wrap"],["type","checkbox",3,"ngModelChange","change","disabled","ngModel"],["size-md","2","size-sm","6","size-xs","12"],["size","small","fill","clear","slot","end",3,"click"],["name","caret-down"],["lines","none",3,"class",4,"ngIf"],[4,"ngIf"],["style","padding-left:15px",4,"ngIf"],["lines","none"],["fixed","",1,"ion-no-padding"],["size","8"],[3,"atividade",4,"ngFor","ngForOf"],[3,"atividade"],[2,"padding-left","15px"]],template:function(o,a){1&o&&(i.j41(0,"ion-item",0)(1,"ion-grid",1),i.bIt("click",function(){return a.check(a.atividade)}),i.j41(2,"ion-row")(3,"ion-col",2)(4,"ion-label",3)(5,"input",4),i.mxI("ngModelChange",function(r){return i.DH7(a.atividade.checked,r)||(a.atividade.checked=r),r}),i.bIt("change",function(){return a.processaArvore(a.atividade)}),i.k0s(),i.EFF(6),i.k0s()(),i.j41(7,"ion-col",5)(8,"ion-label"),i.EFF(9),i.k0s()(),i.j41(10,"ion-col",5)(11,"ion-label"),i.EFF(12),i.nI1(13,"date"),i.k0s()()()(),i.j41(14,"ion-button",6),i.bIt("click",function(){return a.mostraDetalhes=!a.mostraDetalhes}),i.nrm(15,"ion-icon",7),i.k0s()(),i.DNE(16,k,8,9,"ion-item",8)(17,j,2,1,"div",9)(18,I,1,0,"div",10)),2&o&&(i.R7$(4),i.HbH("classe"+a.getNivel(a.atividade.classificacao)),i.R7$(),i.Y8G("disabled",2==a.atividade.checkList),i.R50("ngModel",a.atividade.checked),i.R7$(),i.Lme(" ",a.atividade.classificacao," - ",a.atividade.descricao," "),i.R7$(),i.ZvI("classe-recurso",a.getNivel(a.atividade.classificacao),""),i.R7$(2),i.JRh(a.atividade.recurso),i.R7$(),i.ZvI("classe-recurso",a.getNivel(a.atividade.classificacao),""),i.R7$(2),i.JRh(i.i5U(13,17,a.atividade.dataAgenda,"dd/MM/yy")),i.R7$(4),i.Y8G("ngIf",a.mostraDetalhes),i.R7$(),i.Y8G("ngIf",a.atividade.atividades),i.R7$(),i.Y8G("ngIf",!a.atividade.atividades))},dependencies:[s.Jm,s.hU,s.lO,s.iq,s.uz,s.he,s.ln,g.Sq,g.bT,h.Zm,h.BC,h.vS,n,g.vh],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center}.wrap[_ngcontent-%COMP%]{overflow:hidden;text-wrap:nowrap;text-overflow:ellipsis}input[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked:before, .checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .checkbox-icon[_ngcontent-%COMP%]:before{background:red!important;border-color:red!important}.classe0[_ngcontent-%COMP%]{padding-left:0}.classe1[_ngcontent-%COMP%]{padding-left:30px}.classe2[_ngcontent-%COMP%]{padding-left:60px}@media only screen and (min-width: 540px){.classe-recurso[_ngcontent-%COMP%]{padding-left:0}}@media only screen and (max-width: 768px){.classe-recurso0[_ngcontent-%COMP%]{padding-left:30px}.classe-recurso1[_ngcontent-%COMP%]{padding-left:60px}.classe-recurso2[_ngcontent-%COMP%]{padding-left:90px}}.linhaDetalhe[_ngcontent-%COMP%]{font-size:80%}ion-item[_ngcontent-%COMP%]:hover{--background: lightgray}"]})}return n})();var F=l(7162);function P(n,d){if(1&n){const e=i.RV6();i.j41(0,"ion-chip",28),i.bIt("click",function(){i.eBV(e);const a=i.XpG();return i.Njj(a.db.revalidaToken(a.db.app.token))}),i.EFF(1),i.k0s()}if(2&n){const e=i.XpG();i.R7$(),i.SpI(" Saindo em ",e.db.timer," min ")}}function T(n,d){if(1&n&&(i.j41(0,"ion-badge",29),i.EFF(1),i.k0s()),2&n){const e=i.XpG();i.R7$(),i.JRh(e.db.qtdNotificacoes)}}function O(n,d){if(1&n&&(i.j41(0,"ion-select-option",30),i.EFF(1),i.k0s()),2&n){const e=d.$implicit;i.Y8G("value",e),i.R7$(),i.JRh(e)}}function A(n,d){if(1&n){const e=i.RV6();i.j41(0,"div",31)(1,"ion-grid")(2,"ion-row")(3,"ion-col",18)(4,"p",32),i.EFF(5),i.k0s()(),i.j41(6,"ion-col",18)(7,"grp-input",33),i.mxI("ngModelChange",function(a){i.eBV(e);const t=i.XpG();return i.DH7(t.os.observacao,a)||(t.os.observacao=a),i.Njj(a)}),i.k0s()()()()()}if(2&n){const e=i.XpG();i.R7$(5),i.JRh(null==e.os?null:e.os.servico),i.R7$(2),i.R50("ngModel",e.os.observacao)}}function D(n,d){if(1&n&&(i.j41(0,"div",35),i.nrm(1,"app-atividade",36),i.k0s()),2&n){const e=d.$implicit;i.R7$(),i.Y8G("atividade",e)}}function N(n,d){if(1&n&&(i.j41(0,"div"),i.DNE(1,D,2,1,"div",34),i.k0s()),2&n){const e=i.XpG();i.R7$(),i.Y8G("ngForOf",e.atividades)}}function G(n,d){if(1&n){const e=i.RV6();i.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"ion-label",37),i.EFF(4," Observacao da Baixa "),i.k0s(),i.j41(5,"ion-textarea",38),i.mxI("ngModelChange",function(a){i.eBV(e);const t=i.XpG();return i.DH7(t.os.observacaoBaixa,a)||(t.os.observacaoBaixa=a),i.Njj(a)}),i.k0s()()(),i.j41(6,"ion-row")(7,"ion-col",39)(8,"grp-input",40),i.mxI("ngModelChange",function(a){i.eBV(e);const t=i.XpG();return i.DH7(t.os.dataBaixa,a)||(t.os.dataBaixa=a),i.Njj(a)}),i.k0s()(),i.j41(9,"ion-col",39)(10,"grp-input",41),i.bIt("ionChange",function(){i.eBV(e);const a=i.XpG();return i.Njj(a.calculaTotalHoras())}),i.mxI("ngModelChange",function(a){i.eBV(e);const t=i.XpG();return i.DH7(t.os.horaIni,a)||(t.os.horaIni=a),i.Njj(a)}),i.k0s()(),i.j41(11,"ion-col",39)(12,"grp-input",42),i.bIt("ionChange",function(){i.eBV(e);const a=i.XpG();return i.Njj(a.calculaTotalHoras())}),i.mxI("ngModelChange",function(a){i.eBV(e);const t=i.XpG();return i.DH7(t.os.horaFim,a)||(t.os.horaFim=a),i.Njj(a)}),i.k0s()(),i.j41(13,"ion-col",39)(14,"grp-input",43),i.bIt("ionChange",function(){i.eBV(e);const a=i.XpG();return i.Njj(a.calculaTotalHoras())}),i.mxI("ngModelChange",function(a){i.eBV(e);const t=i.XpG();return i.DH7(t.os.intervalo,a)||(t.os.intervalo=a),i.Njj(a)}),i.k0s()(),i.j41(15,"ion-col",39)(16,"grp-input",44),i.mxI("ngModelChange",function(a){i.eBV(e);const t=i.XpG();return i.DH7(t.os.totalHoras,a)||(t.os.totalHoras=a),i.Njj(a)}),i.k0s()(),i.j41(17,"ion-col",39)(18,"ion-button",45),i.bIt("click",function(){i.eBV(e);const a=i.XpG();return i.Njj(a.baixa())}),i.EFF(19," Baixar "),i.k0s()()()()}if(2&n){const e=i.XpG();i.R7$(5),i.R50("ngModel",e.os.observacaoBaixa),i.R7$(3),i.R50("ngModel",e.os.dataBaixa),i.R7$(2),i.R50("ngModel",e.os.horaIni),i.R7$(2),i.R50("ngModel",e.os.horaFim),i.R7$(2),i.R50("ngModel",e.os.intervalo),i.R7$(2),i.R50("ngModel",e.os.totalHoras)}}const E=[{path:"",component:(()=>{class n{osSvc;router;nav;db;route;info;atividadesBaixa;atividades;atividadeFiltro;os;dataBaixa;strAtividades=" ";observacao;rotuloSingular="Baixa";rotuloPlural="Baixas";mostraDetalhes=!1;scrollY;agendaSelecionada=["TODOS"];recursos=[];baixado="AMBOS";constructor(e,o,a,t,r,c){this.osSvc=e,this.router=o,this.nav=a,this.db=t,this.route=r,this.info=c,this.route.getCurrentNavigation().extras.state&&(this.os=this.route.getCurrentNavigation().extras.state.ag.os,this.scrollY=this.route.getCurrentNavigation().extras.state.pos,console.log(this.scrollY),this.setPai(this.os.atividades,null),console.log(this.os.atividades),this.os.observacaoBaixa=" ",this.os.dataBaixa=" ",this.os.horaIni="",this.os.horaFim="",this.os.intervalo="",this.os.totalHoras="")}ngOnInit(){}ionViewDidEnter(){let e=new Date;this.strAtividades=" ",this.os?(this.os.observacaoBaixa=" ",this.os.dataBaixa=e.getFullYear().toString()+"-"+(e.getMonth()>8?(e.getMonth()+1).toString():"0"+(e.getMonth()+1).toString())+"-"+(e.getUTCDate()>9?e.getUTCDate().toString():"0"+e.getUTCDate().toString()),this.os.horaIni="",this.os.horaFim="",this.os.intervalo="",this.os.totalHoras="",console.log(this.os),this.atividades=this.os.atividades,this.atividadeFiltro=this.os.atividades,this.montaComboRecurso()):this.nav.navigateBack("/agenda")}mostraInfoBaixa(e){var o=this;return(0,f.A)(function*(){const a=yield o.info.mostraInfoBaixa(e);console.log(a.data)})()}montaComboRecurso(){this.atividades.forEach(o=>{this.recursos.push(o.recurso)});const e=new Set(this.recursos);this.recursos=Array.from(e)}setPai(e,o){e.forEach(a=>{a.pai=o,a.atividades&&this.setPai(a.atividades,a)})}getArvoreAtividades(e){for(let o=0;o<e.length;o++)this.strAtividades+=e[o].descricao+"</br>",e[o].atividades&&this.getArvoreAtividades(e[o].atividades);return console.log(this.strAtividades),this.strAtividades}getAtividade(e){e.forEach(o=>{o.checked!=o.checkedAnt&&this.atividadesBaixa.push({id:o.id,classificacao:o.classificacao,percConcl:o.checked?100:0}),o.atividades&&this.getAtividade(o.atividades)})}baixa(){console.log("baixa");let e=this.os,o=e.atividades;this.atividadesBaixa=[],this.getAtividade(o),console.log(this.atividadesBaixa),e.atividades=this.atividadesBaixa,this.db.mostraProcessando(),this.osSvc.Baixa({token:this.db.app.token,os:e}).subscribe(t=>{console.log("baixa11"),t&&t.status&&(console.log(t),this.volta()),this.db.escondeProcessando(t.msg)},t=>{console.log(t),this.db.escondeProcessando(t)}),console.log("baixa2"),console.log({token:this.db.app.token,os:this.os,atividades:this.atividades})}calculaTotalHoras(){if(this.os.horaIni&&this.os.horaFim){this.os.totalHoras="00:00";let e=this.os.horaIni.split(":"),o=this.os.horaFim.split(":");if(e[0]&&e[1]&&o[0]&&o[1]){let a=this.os.intervalo.split(":"),t=new Date(0,0,0,+e[0],+e[1],0),m=new Date(0,0,0,+o[0],+o[1],0).getTime()-t.getTime()-60*(+a[0]>0?+a[0]:0)*60*1e3-60*(+a[1]?+a[1]:0)*1e3,u=Math.floor(m/1e3/60/60),_=Math.floor((m-1e3*u*60*60)/1e3/60);u>=0&&_>=0&&(this.os.totalHoras=(u<=9?"0":"")+u+":"+(_<=9?"0":"")+_)}}}arvore(){}volta(){this.route.navigate(["/agenda"],{state:{pos:this.scrollY}})}filtra(){console.log(this.agendaSelecionada),console.log(this.atividadeFiltro),this.atividades=this.agendaSelecionada.includes("TODOS")?this.atividadeFiltro:this.atividadeFiltro.filter(e=>this.agendaSelecionada.includes(e.recurso)),"AMBOS"!==this.baixado&&(console.log("BAIXADO"==this.baixado),this.atividades=this.atividades.filter(e=>"BAIXADO"==this.baixado?1==e.checked:!e.checked||0==e.checked))}static \u0275fac=function(o){return new(o||n)(i.rXU(b.a),i.rXU(p.nX),i.rXU(x.q9),i.rXU(B.a),i.rXU(p.Ix),i.rXU(C.a))};static \u0275cmp=i.VBU({type:n,selectors:[["app-baixa"]],decls:49,vars:12,consts:[["head",""],["color","primary",1,"alturamenor"],["collapse","true","slot","start",1,"alturamenor"],[1,"alturamenor"],[3,"click"],["slot","icon-only","name","arrow-back-outline"],["slot","end",1,"alturamenor"],["class","sessao",3,"click",4,"ngIf"],["slot","start","name","logo-whatsapp"],["slot","icon-only","name","notifications-outline"],["top","","color","danger",4,"ngIf"],["lines","none"],["slot","start"],["slot","end"],["fill","clear","slot","end",3,"click"],["slot","icon-only","name","caret-down"],["slot","icon-only","name","checkmark-done-outline"],["fixed",""],["size","6"],["multiple","false","placeholder","Baixado/NaoBaixado",3,"ngModelChange","ionChange","ngModel"],["value","AMBOS"],["value","BAIXADO"],["value","NAO BAIXADO"],["multiple","true","placeholder","Selecione a Agenda",3,"ngModelChange","ionChange","ngModel"],["value","TODOS"],[3,"value",4,"ngFor","ngForOf"],["class","container",4,"ngIf"],[4,"ngIf"],[1,"sessao",3,"click"],["top","","color","danger"],[3,"value"],[1,"container"],[1,"linha2"],["label","Observacao","name","observacao",3,"ngModelChange","ngModel"],["class","camposAux",4,"ngFor","ngForOf"],[1,"camposAux"],[3,"atividade"],["position","relative",1,"label"],["name","observacaoBaixa",1,"input",3,"ngModelChange","ngModel"],["size-md","2","size-sm","6","size-xs","12"],["label","Data Baixa","name","dataBaixa","type","date",3,"ngModelChange","ngModel"],["debounce","500","type","time","label","Hora Inicio","name","horaIni",3,"ionChange","ngModelChange","ngModel"],["debounce","500","type","time","label","Hora T\xe9rmino","name","horaFim",3,"ionChange","ngModelChange","ngModel"],["debounce","500","type","time","label","Intervalo","name","intervalo",3,"ionChange","ngModelChange","ngModel"],["label","Total de Hora","type","text","name","totalHoras",3,"ngModelChange","ngModel"],["expand","block","shape","round",3,"click"]],template:function(o,a){if(1&o){const t=i.RV6();i.j41(0,"ion-header",null,0)(2,"ion-toolbar",1)(3,"ion-buttons",2),i.nrm(4,"ion-menu-button",3),i.j41(5,"ion-button",4),i.bIt("click",function(){return i.eBV(t),i.Njj(a.volta())}),i.nrm(6,"ion-icon",5),i.k0s()(),i.j41(7,"ion-buttons",6),i.DNE(8,P,2,1,"ion-chip",7),i.j41(9,"ion-button",4),i.bIt("click",function(){return i.eBV(t),i.Njj(a.db.sendWhats())}),i.nrm(10,"ion-icon",8),i.k0s(),i.j41(11,"ion-button",3),i.nrm(12,"ion-icon",9),i.DNE(13,T,2,1,"ion-badge",10),i.k0s()(),i.j41(14,"ion-title"),i.EFF(15),i.k0s()(),i.j41(16,"ion-toolbar")(17,"ion-item",11)(18,"ion-label",12),i.EFF(19),i.k0s(),i.j41(20,"ion-label"),i.EFF(21),i.k0s(),i.j41(22,"ion-label",13),i.EFF(23),i.k0s(),i.j41(24,"ion-button",14),i.bIt("click",function(){return i.eBV(t),i.Njj(a.mostraDetalhes=!a.mostraDetalhes)}),i.nrm(25,"ion-icon",15),i.k0s(),i.j41(26,"ion-button",14),i.bIt("click",function(){return i.eBV(t),i.Njj(a.mostraInfoBaixa(a.os))}),i.nrm(27,"ion-icon",16),i.k0s()(),i.j41(28,"ion-toolbar")(29,"ion-grid",17)(30,"ion-row")(31,"ion-col",18)(32,"ion-select",19),i.mxI("ngModelChange",function(c){return i.eBV(t),i.DH7(a.baixado,c)||(a.baixado=c),i.Njj(c)}),i.bIt("ionChange",function(){return i.eBV(t),i.Njj(a.filtra())}),i.j41(33,"ion-select-option",20),i.EFF(34,"AMBOS"),i.k0s(),i.j41(35,"ion-select-option",21),i.EFF(36,"BAIXADO"),i.k0s(),i.j41(37,"ion-select-option",22),i.EFF(38,"NAO BAIXADO"),i.k0s()()(),i.j41(39,"ion-col",18)(40,"ion-select",23),i.mxI("ngModelChange",function(c){return i.eBV(t),i.DH7(a.agendaSelecionada,c)||(a.agendaSelecionada=c),i.Njj(c)}),i.bIt("ionChange",function(){return i.eBV(t),i.Njj(a.filtra())}),i.j41(41,"ion-select-option",24),i.EFF(42,"TODOS"),i.k0s(),i.DNE(43,O,2,2,"ion-select-option",25),i.k0s()()()()()(),i.DNE(44,A,8,2,"div",26),i.k0s(),i.j41(45,"ion-content"),i.DNE(46,N,2,1,"div",27),i.k0s(),i.j41(47,"ion-footer"),i.DNE(48,G,20,6,"ion-grid",27),i.k0s()}2&o&&(i.R7$(8),i.Y8G("ngIf",a.db.timer<=a.db.minMostraTimer),i.R7$(5),i.Y8G("ngIf",a.db.qtdNotificacoes>0),i.R7$(2),i.JRh(a.rotuloPlural),i.R7$(4),i.JRh(null==a.os?null:a.os.cliente),i.R7$(2),i.JRh(null==a.os?null:a.os.codigoCliente),i.R7$(2),i.JRh(null==a.os?null:a.os.id),i.R7$(9),i.R50("ngModel",a.baixado),i.R7$(8),i.R50("ngModel",a.agendaSelecionada),i.R7$(3),i.Y8G("ngForOf",a.recursos),i.R7$(),i.Y8G("ngIf",a.mostraDetalhes),i.R7$(2),i.Y8G("ngIf",a.atividades),i.R7$(2),i.Y8G("ngIf",a.os))},dependencies:[g.Sq,g.bT,h.BC,h.vS,s.In,s.Jm,s.QW,s.ZB,s.hU,s.W9,s.M0,s.lO,s.eU,s.iq,s.uz,s.he,s.MC,s.ln,s.Nm,s.Ip,s.nc,s.BC,s.ai,s.Je,s.Gw,R,F.T],styles:["ion-content[_ngcontent-%COMP%]{border:1px solid black}.container[_ngcontent-%COMP%]{display:flex;align-items:center;padding-bottom:10px}.linha2[_ngcontent-%COMP%]{font-size:80%}ion-input[_ngcontent-%COMP%]{border:solid 1px;border-radius:10px}.input[_ngcontent-%COMP%]{border:solid .5px var(--ion-color-primary);border-radius:10px;margin-bottom:5px}@media (max-width: 800px){ion-footer[_ngcontent-%COMP%]{max-height:200px;overflow:overlay}}"]})}return n})()}];let y=(()=>{class n{static \u0275fac=function(o){return new(o||n)};static \u0275mod=i.$C({type:n});static \u0275inj=i.G2t({imports:[p.iI.forChild(E),p.iI]})}return n})();var S=l(4780),X=l(5553);let H=(()=>{class n{static \u0275fac=function(o){return new(o||n)};static \u0275mod=i.$C({type:n});static \u0275inj=i.G2t({imports:[g.MD,h.YN,s.bv,y,S.Q,X.h]})}return n})()}}]);